{% block stylesheets %}
	<link href="https://transloadit.edgly.net/releases/uppy/v1.19.2/uppy.min.css" rel="stylesheet">
	<style>
		label {
			text-align: left !important;
		}
		.preview-images-zone {
			width: 100%;
			border: 1px solid #ddd;
			min-height: 180px;
			/* display: flex; */
			padding: 5px 5px 0;
			position: relative;
			overflow: auto;
		}

		.preview-images-zone>.preview-image:first-child {
			height: 185px;
			width: 40%;
			position: relative;
			margin-right: 5px;
		}

		.preview-images-zone > .preview-image {
			height: 185px;
			width: 40%;
			position: relative;
			margin-right: 5px;
			float: left;
			margin-bottom: 5px;
		}

		.preview-images-zone > .preview-image > .image-zone {
			width: 100%;
			height: 100%;
		}

		.preview-images-zone > .preview-image > .image-zone > img {
			width: 100%;
			height: 100%;
		}

		.preview-images-zone > .preview-image > .tools-edit-image {
			position: absolute;
			z-index: 100;
			color: #fff;
			bottom: 0;
			width: 100%;
			text-align: center;
			margin-bottom: 10px;
			display: none;
		}

		.preview-images-zone > .preview-image > .image-cancel {
			text-align: center;
			font-size: 18px;
			top: 0;
			width: 100%;
			right: 0;
			font-weight: bold;
			margin-right: 10px;
			cursor: pointer;
			display: none;
			z-index: 100;
		}

		.preview-image:hover > .image-zone {
			cursor: move;
			opacity: .5;
		}

		.preview-image:hover>.tools-edit-image,
		.preview-image:hover > .image-cancel {
			display: block;
		}

		.ui-sortable-helper {
			width: 90px !important;
			height: 90px !important;
		}

		.container {
			padding-top: 50px;
		}
	</style>
{% endblock %}
{% block body %}
	{% include('back_end/index.html.twig') %}
	<div class="page-wrapper">
		<div style="height: 7%;">
			<h4 class="page-title" style="margin-left: 15px;padding-top: 20px;">Ajouter un service</h4>
		</div>
		<div class="container-fluid" style="    height: 100%;">
			<form method="post" action="{{ path('ServiceAdd') }}" enctype="multipart/form-data">
				<div class="card" style="width: 95%;align-items: center;">
					<div class="card-body" style="width: 80%;">
						<div class="form-group row">
							<label for="fname" class="col-sm-3  control-label col-form-label">
								<i class="mdi mdi-cursor-text"></i>
								Nom Services :</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="p1" name="title" placeholder="First Name Here" {% if Service != null %} value="{{ Service.titre }}" {% endif %}>
							</div>
						</div>
						<div class="form-group row">
							<label for="cono1" class="col-sm-3  control-label col-form-label">
								<i class="mdi mdi-file-document-box"></i>
								Desription :
							</label>
							<div class="col-sm-9">
								<textarea class="form-control" id="p2" name="description">{% if Service != null %}{{ Service.Decription }}{% endif %}</textarea>
							</div>
						</div>
						<div class="form-group row">
							<div class="input-group">
								<label for="cono1" class="col-sm-3  control-label col-form-label">
									<i class="mdi mdi-cash"></i>
									Prix :
								</label>
								<input type="number" class="form-control" id="p3" placeholder="5.000" aria-label="Recipient 's username" name="prix" aria-describedby="basic-addon2" {% if Service != null %} value="{{ Service.prix }}" {% endif %}>
								<div class="input-group-append">
									<span class="input-group-text" id="basic-addon2">DH</span>
								</div>
							</div>
						</div>
						<fieldset class="form-group row">
							<label for="cono1" class="col-sm-8  control-label col-form-label">
								<i class="mdi mdi-camera"></i>
								Media (Image / Video) :
							</label>
							<a class="form-control btn btn-success" href="javascript:void(0)" onclick="$('#pro-image').click()">Importer</a>
							<input type="file" id="pro-image" name="pro-image[]" style="display: none;" class="form-control" multiple>
							<div class="preview-images-zone">
								{% if Service != null %}
									{% for item in Service.media %}
									{% set image =   item.url|reverse  %}
										<div class="preview-image preview-show-{{ item.id  }}">
											<div class="image-cancel btn-danger" data-no="{{ item.id }}">Supprimer</div>
											<input name="id" type="hidden" value="{{ Service.id }}">
											<input name="id_File[]" type="hidden" value="{{ item.id }}">
											<div class="image-zone"><img id="pro-img-' + num + '" src="{{ image[7:]|reverse }}" style="object-fit: contain;"></div>
										</div>
									{% endfor %}

								{% endif %}
							</div>
						</fieldset>
					</div>
					<div class="card-footer" style="width: 100%; text-align: center;">
						<button type="submit" class="btn btn-outline-success" style="margin-right:10%;" disabled>Success</button>
						<button type="button" class="btn btn-outline-danger">Danger</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>{% endblock %}{% block javascripts %}
<script src="https://transloadit.edgly.net/releases/uppy/v1.19.2/uppy.min.js"></script>
<script>
	$(document).ready(function () {
document.getElementById('pro-image').addEventListener('change', readImage, false);
$(document).on('click', '.image-cancel', function () {
let no = $(this).data('no');
check();
$(".preview-image.preview-show-" + no).remove();
});
});


var num = 0;
function readImage() {
if (window.File && window.FileList && window.FileReader) {
var files = event.target.files; // FileList object
var output = $(".preview-images-zone");

for (let i = 0; i < files.length; i++) {
var file = files[i];
if (file.type.match('image')) {
var picReader = new FileReader();
if (file.type.match('image')) {


picReader.addEventListener('load', function (event) {
var picFile = event.target;
var html = '<div class="preview-image preview-show-' + num + '">' + '<div class="image-cancel btn-danger" data-no="' + num + '">Supprimer</div>' + '<div class="image-zone"><img id="pro-img-' + num + '" src="' + picFile.result + '" style="object-fit: contain;"></div>' + '</div>';

output.append(html);
num = num + 1;
});
}
picReader.readAsDataURL(file);

} else {
alert('Fichier non supporter');
}
}
// $("#pro-image").val('');
} else {
console.log('Browser not support');
}
}


$('#p1').on('change', function () {
check();
});
$('#p2').on('change', function () {
check();
});
$('#p3').on('change', function () {
check();
});

function check() {
if ($('#p1').val() != "" && $('#p2').val() != "" && $('#p3').val() != "") {
$('.btn-outline-success').prop("disabled", false);
} else {
console.log('no');
}
}

{% if Add == true %}
tata.success('Service ajouter avec succes', 'Consulter vos services', {duration: 5000})
{% elseif Update == true %}
tata.success('Service Modifier avec succes', 'Consulter vos services', {duration: 5000})
{% endif %}
</script>{% endblock %}
